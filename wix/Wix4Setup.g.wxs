<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
    To suppress generation of this file remove `set ide=true` from the PostBuildEvent of the VS project
</auto-generated>
-->
  <Package Compressed="yes" ProductCode="5d0f56c2-bbd6-4f70-aefe-217df9b1ac67" Name="SupHelper2" Language="1049" Version="1.0.0" UpgradeCode="5d0f56c2-bbd6-4f70-aefe-217de9b19c67" Manufacturer="ChatAppDev" Scope="perUser" InstallerVersion="200">
    <SummaryInformation Codepage="Windows-1252" />
    <Media Id="1" Cabinet="SupHelper2_.cab" EmbedCab="yes" />

    <StandardDirectory Id="AppDataFolder">

      <Component Id="Component.DirPermission" Guid="5d0f56c2-bbd6-4f70-aefe-217db25b0c03">
        <CreateFolder>
          <PermissionEx User="Users" ChangePermission="yes" GenericAll="yes" xmlns="http://wixtoolset.org/schemas/v4/wxs/util" />
        </CreateFolder>

        <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
          <RegistryValue Value="0" Type="string" KeyPath="yes" />
        </RegistryKey>
      </Component>

      <Directory Id="ChatApp" Name="ChatApp">
        <Directory Id="INSTALLDIR" Name="SupHelper2">

          <Component Id="Component.icon.ico_777399353" Guid="5d0f56c2-bbd6-4f70-aefe-217dc4e8f67f">
            <File Id="icon.ico_777399353" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\icon.ico" />
            <RemoveFolder Id="INSTALLDIR" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.MainForm.cs_2394418646" Guid="5d0f56c2-bbd6-4f70-aefe-217d5458c91e">
            <File Id="MainForm.cs_2394418646" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\MainForm.cs" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Newtonsoft.Json.dll_2552799202" Guid="5d0f56c2-bbd6-4f70-aefe-217d95ca98b2">
            <File Id="Newtonsoft.Json.dll_2552799202" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Newtonsoft.Json.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Suphelper2.deps.json_2334358103" Guid="5d0f56c2-bbd6-4f70-aefe-217d23b3248b">
            <File Id="Suphelper2.deps.json_2334358103" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Suphelper2.deps.json" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Suphelper2.dll_2563438543" Guid="5d0f56c2-bbd6-4f70-aefe-217dd79de4b4">
            <File Id="Suphelper2.dll_2563438543" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Suphelper2.dll" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Suphelper2.exe_3774078555" Guid="5d0f56c2-bbd6-4f70-aefe-217d4036db4f">
            <File Id="Suphelper2.exe_3774078555" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Suphelper2.exe" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Suphelper2.pdb_3369483329" Guid="5d0f56c2-bbd6-4f70-aefe-217dcda0e27b">
            <File Id="Suphelper2.pdb_3369483329" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Suphelper2.pdb" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Suphelper2.runtimeconfig.json_1100901956" Guid="5d0f56c2-bbd6-4f70-aefe-217dee332601">
            <File Id="Suphelper2.runtimeconfig.json_1100901956" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\Suphelper2.runtimeconfig.json" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Directory Id="DesktopFolder" Name="DesktopFolder">

            <Component Id="Component.SupHelper2___" Guid="5d0f56c2-bbd6-4f70-aefe-217dc7479093" Condition="INSTALLDESKTOPSHORTCUT=&quot;True&quot;">
              <Shortcut Id="DesktopFolder.SupHelper2___" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]SupHelper2.exe" Name="SupHelper2.lnk" />

              <CreateFolder />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

          </Directory>

          <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">

            <Component Id="Component.SupHelper2.1" Guid="5d0f56c2-bbd6-4f70-aefe-217dfe47f50b" Condition="INSTALLMENUSHORTCUT=&quot;True&quot;">
              <Shortcut Id="ProgramMenuFolder.SupHelper2.1" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]SupHelper2.exe" Name="SupHelper2.lnk" />

              <CreateFolder />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

          </Directory>

          <Directory Id="StartupFolder" Name="StartupFolder">

            <Component Id="Component.SupHelper2.2" Guid="5d0f56c2-bbd6-4f70-aefe-217dfe4af50b" Condition="ADDINSTARTUPSHOTCUT=&quot;True&quot;">
              <Shortcut Id="StartupFolder.SupHelper2.2" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]SupHelper2.exe" Name="SupHelper2.lnk" />

              <CreateFolder />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

          </Directory>

          <Directory Id="config" Name="config">

            <Component Id="Component.config.json_1595705852" Guid="5d0f56c2-bbd6-4f70-aefe-217d79536923">
              <File Id="config.json_1595705852" Source="..\Suphelper2\bin\Release\net8.0-windows\publish\config\config.json" />
              <RemoveFolder Id="config" On="uninstall" />

              <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
                <RegistryValue Value="0" Type="string" KeyPath="yes" />
              </RegistryKey>
            </Component>

          </Directory>
        </Directory>

        <Component Id="ChatApp" Guid="5d0f56c2-bbd6-4f70-aefe-217d3fa5fc3e">
          <RemoveFolder Id="ChatApp" On="uninstall" />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

      </Directory>

      <Directory Id="ProgramFilesFolder" Name="ProgramFilesFolder">

        <Component Id="Registry.1" Guid="5d0f56c2-bbd6-4f70-aefe-217de6ce6ae6">
          <RegistryKey Root="HKCU" Key="Software\ChatAppDev\SupHelper2">
            <RegistryValue Id="InstallPath" Type="string" Value="[INSTALLDIR]" Name="InstallPath" />
          </RegistryKey>

          <CreateFolder />
          <RemoveFolder Id="ProgramFilesFolder" On="uninstall" />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

      </Directory>
    </StandardDirectory>

    <UI />

    <Icon Id="app_icon.ico" SourceFile="icon.ico" />

    <WixUI Id="WixUI_Minimal" xmlns="http://wixtoolset.org/schemas/v4/wxs/ui" />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="WixSharp.UI.CA.dll" />
    </UI>

    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="CancelRequestHandler" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />
    <Binary Id="ui_shell_icon" SourceFile="icon.ico" />
    <Binary Id="WixSharp_UIText" SourceFile="..\..\..\..\..\..\..\..\ProgramData\WixSharp\2.6.2.0\WixUI_ru-ru.wxl" />
    <Binary Id="WixSharp_LicenceFile" SourceFile="License.rtf" />
    <Binary Id="WixSharpUI_Bmp_Dialog" SourceFile="SupHelper2.dialog_bmp.png" />
    <Binary Id="WixSharpUI_Bmp_Banner" SourceFile="SupHelper2.dialog_banner.png" />

    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="INSTALLDESKTOPSHORTCUT" Value="False" />
    <Property Id="INSTALLMENUSHORTCUT" Value="False" />
    <Property Id="ADDINSTARTUPSHOTCUT" Value="False" />
    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="WixSharp.UI, Version=2.6.2.0, Culture=neutral, PublicKeyToken=13407310932706d5|WixSharp.UI.Forms.WelcomeDialog&#xA;WixSharp.UI, Version=2.6.2.0, Culture=neutral, PublicKeyToken=13407310932706d5|WixSharp.UI.Forms.LicenceDialog&#xA;Wix4Setup, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|WixSharpSetup.ShortcutDialog&#xA;WixSharp.UI, Version=2.6.2.0, Culture=neutral, PublicKeyToken=13407310932706d5|WixSharp.UI.Forms.InstallDirDialog&#xA;WixSharp.UI, Version=2.6.2.0, Culture=neutral, PublicKeyToken=13407310932706d5|WixSharp.UI.Forms.ProgressDialog&#xA;WixSharp.UI, Version=2.6.2.0, Culture=neutral, PublicKeyToken=13407310932706d5|WixSharp.UI.Forms.ExitDialog" />
    <Property Id="ARPPRODUCTICON" Value="app_icon.ico" />

    <Feature Id="Complete" Title="Complete" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component.DirPermission" />
      <ComponentRef Id="Component.icon.ico_777399353" />
      <ComponentRef Id="Component.MainForm.cs_2394418646" />
      <ComponentRef Id="Component.Newtonsoft.Json.dll_2552799202" />
      <ComponentRef Id="Component.Suphelper2.deps.json_2334358103" />
      <ComponentRef Id="Component.Suphelper2.dll_2563438543" />
      <ComponentRef Id="Component.Suphelper2.exe_3774078555" />
      <ComponentRef Id="Component.Suphelper2.pdb_3369483329" />
      <ComponentRef Id="Component.Suphelper2.runtimeconfig.json_1100901956" />
      <ComponentRef Id="Component.SupHelper2___" />
      <ComponentRef Id="Component.SupHelper2.1" />
      <ComponentRef Id="Component.SupHelper2.2" />
      <ComponentRef Id="Component.config.json_1595705852" />
      <ComponentRef Id="Registry.1" />
      <ComponentRef Id="ChatApp" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Condition=" (1) " Action="WixSharp_InitRuntime_Action" Before="AppSearch" />
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Condition=" (1) " Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props" />
    </InstallExecuteSequence>
  </Package>
</Wix>

